import{r as _,u as C,j as e,H as L,L as h,a as M}from"./app-CX5FMW1s.js";import{A as $}from"./AdminLayout-Bv6JVXqp.js";function B({project:s,developmentCategories:g}){const[b,m]=_.useState(!1),{data:a,setData:d,post:p,processing:x,errors:r,reset:u}=C({development_category_id:"",amount:"",description:"",expense_date:new Date().toISOString().split("T")[0],receipt_number:""}),l=t=>new Intl.NumberFormat("ar-IQ",{style:"currency",currency:"IQD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0),n=t=>t?new Date(t).toLocaleDateString("ar-IQ"):"غير محدد",j=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=t=>{switch(t){case"unpaid":return"bg-red-100 text-red-800 border-red-200";case"partial":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"paid":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},v=t=>{switch(t){case"pending":return"قيد الانتظار";case"in_progress":return"قيد التنفيذ";case"completed":return"مكتمل";case"cancelled":return"ملغي";default:return"غير محدد"}},N=t=>{switch(t){case"unpaid":return"غير مدفوع";case"partial":return"مدفوع جزئياً";case"paid":return"مدفوع بالكامل";default:return"غير محدد"}},i=s.development_costs?.reduce((t,k)=>t+parseFloat(k.amount||0),0)||0,c=s.paid_amount-i,o=s.project_value-i,f=t=>{t.preventDefault(),p(route("admin.client-projects.development-costs.store",s.id),{onSuccess:()=>{m(!1),u()}})},w=t=>{confirm("هل أنت متأكد من حذف هذه التكلفة؟")&&M.delete(route("admin.client-projects.development-costs.destroy",[s.id,t]))};return e.jsxs($,{title:`مشروع: ${s.name}`,children:[e.jsx(L,{title:`مشروع: ${s.name}`}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["العميل: ",s.client_name]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(h,{href:route("admin.client-projects.edit",s.id),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[e.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"تعديل المشروع"]}),e.jsx(h,{href:route("admin.client-projects.index"),className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-lg transition-colors duration-200",children:"العودة للقائمة"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"حالة المشروع"}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${j(s.status)}`,children:v(s.status)})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"حالة الدفع"}),e.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full border ${y(s.payment_status)}`,children:N(s.payment_status)})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"قيمة المشروع"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l(s.project_value)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"المبلغ المدفوع"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l(s.paid_amount)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4m16 0l-4 4m4-4l-4-4"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"كلف التطوير"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:l(i)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${c>=0?"bg-emerald-100":"bg-red-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${c>=0?"text-emerald-600":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"صافي الربح المحقق"}),e.jsx("p",{className:`text-2xl font-bold ${c>=0?"text-emerald-600":"text-red-600"}`,children:l(c)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${o>=0?"bg-purple-100":"bg-red-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${o>=0?"text-purple-600":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"الربح المتوقع"}),e.jsx("p",{className:`text-2xl font-bold ${o>=0?"text-purple-600":"text-red-600"}`,children:l(o)})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"تقدم المشروع"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[Math.round(s.paid_amount/s.project_value*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:`${Math.min(s.paid_amount/s.project_value*100,100)}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2",children:[e.jsxs("span",{children:["مدفوع: ",l(s.paid_amount)]}),e.jsxs("span",{children:["متبقي: ",l(s.remaining_amount)]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"تفاصيل المشروع"}),e.jsxs("div",{className:"space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الوصف"}),e.jsx("p",{className:"text-gray-900",children:s.description})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ البداية"}),e.jsx("p",{className:"text-gray-900",children:n(s.start_date)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"تاريخ الانتهاء"}),e.jsx("p",{className:"text-gray-900",children:n(s.end_date)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"موعد التسليم"}),e.jsx("p",{className:"text-gray-900",children:n(s.delivery_date)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"مدير المشروع"}),e.jsx("p",{className:"text-gray-900",children:s.manager?.name||"غير محدد"})]})]}),s.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات"}),e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:s.notes})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"معلومات العميل"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم العميل"}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.client_name})]}),s.client_phone&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهاتف"}),e.jsx("a",{href:`tel:${s.client_phone}`,className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",children:s.client_phone})]}),s.client_email&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البريد الإلكتروني"}),e.jsx("a",{href:`mailto:${s.client_email}`,className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",children:s.client_email})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"كلف التطوير"}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200",children:[e.jsx("svg",{className:"w-5 h-5 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"إضافة تكلفة"]})]})}),e.jsx("div",{className:"p-6",children:s.development_costs&&s.development_costs.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"الفئة"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"المبلغ"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"الوصف"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-700",children:"التاريخ"}),e.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-700",children:"العمليات"})]})}),e.jsx("tbody",{children:s.development_costs.map(t=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full ml-2",style:{backgroundColor:t.development_category.color}}),t.development_category.name]})}),e.jsx("td",{className:"py-3 px-4 font-semibold text-red-600",children:l(t.amount)}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:t.description||"-"}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:n(t.expense_date)}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("button",{onClick:()=>w(t.id),className:"text-red-600 hover:text-red-800 transition-colors duration-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},t.id))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[e.jsx("td",{className:"py-3 px-4",children:"الإجمالي"}),e.jsx("td",{className:"py-3 px-4 text-red-600",children:l(i)}),e.jsx("td",{className:"py-3 px-4"}),e.jsx("td",{className:"py-3 px-4"}),e.jsx("td",{className:"py-3 px-4"})]})})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"لا توجد كلف تطوير"}),e.jsx("p",{className:"text-gray-600",children:"ابدأ بإضافة أول تكلفة تطوير للمشروع"})]})})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"إضافة تكلفة تطوير"})}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة التطوير *"}),e.jsxs("select",{value:a.development_category_id,onChange:t=>d("development_category_id",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"اختر فئة التطوير"}),g.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),r.development_category_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.development_category_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المبلغ (IQD) *"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:a.amount,onChange:t=>d("amount",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),r.amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الوصف"}),e.jsx("textarea",{value:a.description,onChange:t=>d("description",t.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"وصف التكلفة أو سبب الصرف..."}),r.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الصرف *"}),e.jsx("input",{type:"date",value:a.expense_date,onChange:t=>d("expense_date",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),r.expense_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.expense_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الإيصال"}),e.jsx("input",{type:"text",value:a.receipt_number,onChange:t=>d("receipt_number",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"رقم الإيصال أو المرجع (اختياري)"}),r.receipt_number&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.receipt_number})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{m(!1),u()},className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors duration-200",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200 disabled:opacity-50",children:x?"جاري الحفظ...":"إضافة التكلفة"})]})]})]})})]})}export{B as default};
